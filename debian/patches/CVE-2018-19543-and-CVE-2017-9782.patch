From: Markus Koschany <apo@debian.org>
Date: Fri, 11 Dec 2020 12:08:00 +0100
Subject: CVE-2018-19543 and CVE-2017-9782

Origin: https://github.com/jasper-maint/jasper/pull/38/commits/839b1bcf0450ff036c28e8db40a7abf886e02891
---
 src/libjasper/jp2/jp2_dec.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/src/libjasper/jp2/jp2_dec.c b/src/libjasper/jp2/jp2_dec.c
index 7778fdc..0422d67 100644
--- a/src/libjasper/jp2/jp2_dec.c
+++ b/src/libjasper/jp2/jp2_dec.c
@@ -391,7 +391,7 @@ jas_image_t *jp2_decode(jas_stream_t *in, char *optstr)
 
 	/* Determine the type of each component. */
 	if (dec->cdef) {
-		for (i = 0; i < dec->numchans; ++i) {
+		for (i = 0; i < dec->cdef->data.cdef.numchans; ++i) {
 			/* Is the channel number reasonable? */
 			if (dec->cdef->data.cdef.ents[i].channo >= dec->numchans) {
 				jas_eprintf("error: invalid channel number in CDEF box\n");
