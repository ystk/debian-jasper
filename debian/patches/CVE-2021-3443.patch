Index: jasper-1.900.1-debian1/src/libjasper/jp2/jp2_dec.c
===================================================================
--- jasper-1.900.1-debian1.orig/src/libjasper/jp2/jp2_dec.c	2021-03-27 16:45:04.673816819 +0100
+++ jasper-1.900.1-debian1/src/libjasper/jp2/jp2_dec.c	2021-03-27 16:45:04.665816658 +0100
@@ -416,7 +416,13 @@
 		}
 	} else {
 		for (i = 0; i < dec->numchans; ++i) {
-			jas_image_setcmpttype(dec->image, dec->chantocmptlut[i],
+			unsigned compno = dec->chantocmptlut[i];
+			if (compno >= jas_image_numcmpts(dec->image)) {
+				jas_eprintf(
+				  "error: invalid component reference (%d)\n", compno);
+				goto error;
+			}
+			jas_image_setcmpttype(dec->image, compno,
 			  jp2_getct(jas_image_clrspc(dec->image), 0, i + 1));
 		}
 	}
